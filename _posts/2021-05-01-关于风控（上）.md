---
layout: post
title: 关于风控（上）
summary: 关键词：风控概念、黑产概述、规则引擎
featured-img: shane-rounce-205187
---
### 风控概念

风控是相当广泛的概念，从金融信贷，到电商，支付，游戏，社区......不同业务场景下都各自衍生出结合自身业务的风控理解。我们常看到的一些概念，如：反欺诈、反作弊、信贷管控、内容安全、社区治理、电商治理、平台治理、移动安全、WEB安全、账号安全等，都可以纳入风控的范畴。

传统金融信贷业务是风控概念的源起。用户申请贷款，平台审核信用确定是否放贷及对应额度。贷前审核过程就是风险控制的过程。风控把控不利将直接影响到坏账率从而扩大平台资损。但信贷关注坏账率同时更关注放贷量，后者直接影响营收，所以其风控策略要求有强解释性。在这种背景下，评分卡模型得到了大量普及应用。

电商和O2O主要是构造双边市场，对应的风控其实就是平台治理。平台治理一方面关注供给侧，比如商户的刷单、炒信、虚假商品服务等，另一方面关注消费侧，主要是营销反作弊，也就是薅羊毛。商品服务过程中用户和商家也容易产生纠纷，典型如滴滴的司乘纠纷，纠纷的处理有时候也属于平台治理范畴。

知乎、小红书是以内容为主的社区产品，内容的生产、分发和消费是其产品的核心主线，内容安全是重中之重。用户发布的内容是否符合国家的相关法律法规，平台需要承担主体责任，这一规定确定了内容安全是社区产品的生死线。在内容安全之上，用户发布的内容是否符合平台本身的社区调性，也需要治理和把控，但一般不纳入风控体系，大多归属于社区内容运营。

探探、陌陌是典型的陌生人社交产品，用户在平台内与其他用户建立社交联系，进而发展成稳固的社交关系，平台基于社交关系开展增值付费业务。社交关系的快速建立，使得陌生人社交产品黑产也同样可以基于社交关系积累的信任度进行诈骗和导流，典型的如杀猪盘、狗推等，这是社区风控重点打压的情况。

除上述业务自身特有的风控场景外，APP本身的安全、用户账号的安全等也需要关注，安全上存在漏洞坑会造成用户数据泄露或资产受损。

### 黑产概述

黑产是一个成熟的产业链，有分工、上下游、专业的生产资料、体系化的人员培训等，同时也会受宏观政策影响。想更好了解黑产产业链，不妨先假设自己要做黑产工作室。成立第一步需要以下物料：手机号、移动设备、网络、银行卡、身份证等。这些物料构成了黑产作案的基础生产工具。

为了能够快速给下游提供物料，黑产形成了细分的产业，对下游提供saas服务，比如：

- 接码平台：提供手机号及验证码接收服务；
- 群控工具：将多台手机设备集成到 PC 端统一去管理，提高整体操控效率；
- 代理IP池：提供大量备用IP支持随机切换，用于避开IP黑名单和频控限制策略；
- 改机工具：通过技术手段修改设备信息，绕过设备纬度的防控策略；

获取基础物料后，可以选择细分的黑产业务，比如：

- 虚假流量：批量注册账号用于刷赞、刷点击、刷评论、刷粉等；
- 薅羊毛：以新用户的身份获取平台折扣、返现、抽奖、满减等权益；
- 刷单炒信：通过虚假订单来提高商户的交易量、评分和信用等级等；
- 杀猪盘：诱骗他人投资赌博进行诈骗；
- 狗推：给博彩网站引流；
- 导流：给黑五类产品导流赚取佣金；

黑产不会只开展一个业务，账号注册后可以开展多种黑产行为，直至账号被封禁。业务会根据风险情报和已知作弊内容设计风控策略，黑产同时也会试探业务策略逻辑从而升级作案方式，二者始终处在对抗状态。


### 规则引擎

风控的强对抗性要求策略快速更新迭代，因此规则引擎是非常重要的功能模块。规则引擎在设计上将策略判断和业务代码解耦，从而支持快速部署上线，同时前端以可视化样式进行策略配置，降低配置门槛。

了解规则引擎前先对策略本身抽象。假设有营销活动规定：未满18岁的男性不得领优惠券。针对该策略，用伪代码形式可表述为：当 用户领券 时，如果 用户年龄 小于 18岁，且 用户性别 等于 男性，则 拒绝领券；

对策略解构，可以得到如下元素：

Event：事件，描述策略的执行时机；实时策略对应实时用户行为，离线策略对应定时器；

Rules：规则，规则是对一组表达式做布尔判断；

- 单个表达式可包括左变量、右变量、运算符三部分；
- 习惯上将左变量理解为用户特征，右变量为具体值；
- 运算符连接左右变量，可分为比较运算符和关系运算符；
- 比较运算符：大于、大于等于、等于、不等于、小于、小于等于；
- 关系运算符：在...中、不在...中；
- 多个条件表达式间的逻辑关系引入逻辑运算符 AND 和 OR ；

Action：动作，规则判断为「是」后系统的执行动作；

策略判断一方面依赖语法解析，另一方面需要获取所需数据。规则引擎引用的数据会提前预处理以提高整体执行效率。负责定义和预处理的模块在此文种称为特征平台。特征平台提供特征数据的查询、存储和管理。特征设计的难点在于数据体系如何设计，这反映业务对风险问题的洞察水平。

特征数据根据来源可分为三类：用户画像类、行为频次类、模型分。

- 用户画像类：用户静态或动态的画像数据；
- 行为频次类：行为事件在某个时间窗口内的频次统计；
- 模型分：对应模型的分值；

用户画像类数据是用户的基础数据，典型如：用户年龄、性别、手机号、登录IP、设备名称、使用APP版本、网络类型等。画像数据也可以结合用户行为区分，比如手机号可区分注册手机号和最近登录手机号，其注册数据持久不变，登录数据可根据用户行为动态更新。

行为频次类主要统计用户某个行为事件在时间窗口内统计。其中时间窗口即可以是固定的，比如“视频点赞量”，统计的是视频发出到当前时刻到点赞数量；时间窗口也可以是滑动的，比如“最近30min下单数”，统计的是当前时刻前30min的用户行为数据。

除特征中心数据外，触发事件本身也会携带数据。比如用户私聊事件，私聊内容会存在事件消息体中，此类数据做成特征显然是不合适的。因此，规则引擎也需要支持获取事件流中的数据。产品设计上也会对应有事件管理的模块，用于定义和管理事件及事件流中数据字段的业务语义。

获取规则中引用的数据并能正确判断和制定规则文件的语法，剩下的就是规则引擎的前端可视化。

产品经理有时候会对规则引擎可视化有执念，能够配置的就不想写代码，能够点选的就不想去输入。这在用户体验上是没有问题的，但平台迭代需要全局视角，做什么东西自然重要，但在什么时候去做有时候会更重要。

从0到1搭建规则引擎是一项工作量较大的事情。规则引擎上游需要构建事件和特征服务，本身需要构建和执行语法规范，下游与处罚中心交互，同时架构上要对数据的实时高吞吐做好支撑，保证平台的稳定性。在整个建设环节中，有非常多的边界条件和细节需要去处理，如果一开始就大力追求可视化，往往会在早期消耗核心资源，在平台发展上造成技术欠账，影响后续的迭代效率。

