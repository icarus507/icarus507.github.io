---
layout: post
title: 关于风控（上）
summary: 关键词：风控概念、黑产概述、规则引擎
featured-img: shane-rounce-205187
---
### 风控概念

风控是一个相当广泛的概念，从传统的金融信贷，到电商，支付，游戏，社区......不同业务场景下都各自衍生出一套结合自身业务特点的风控理解。我们常见的很多概念，比如：反欺诈、反作弊、信贷管控、内容安全、社区治理、电商治理、平台治理、移动安全、WEB安全、账号安全等，都可以属于风控的范畴。

金融信贷业务，用户申请贷款，平台审核信用，最终确定是否放贷及对应额度。其中，贷前审核过程本质就是风险控制的过程，如果有用户冒用身份申领到贷款，最终只会形成坏账造成平台资损。

电商和O2O主要是构造双边市场，对应的风控即需要关注供给侧，也需要关注消费侧。供给侧关注商户刷单或者虚假商品或服务等，消费侧则针对的C端用户，主要是营销反作弊，也就是薅羊毛，商品服务过程中也容易产生纠纷，典型的如滴滴的司乘纠纷，这也属于平台治理的范畴。

知乎、小红书是以内容为主的社区产品，内容的生产、分发和消费是其产品的核心主线。针对用户发布的内容是否符合国家的相关法律法规，平台需要承担主体责任，因此内容安全是其风控的一个重要部分。同时，发布内容是否符合平台自身的社区调性，有时也会纳入社区治理来作为风控的子方向。

探探、陌陌是典型的陌生人社交产品，用户在平台内可与其他用户建立社交联系进而发展成稳固的社交关系。与此同时，黑产也同样可以基于社交关系积累的信任度进行诈骗和导流，典型的如杀猪盘、狗推等，这是社区风控重点打压的情况。

除上述业务风控场景外，APP本身的安全、用户账号的安全，也需要关注，避免造成用户数据泄露或资产受损等问题。

### 黑产概述

黑产是一个产业链，有产业上下游、有特定的生产资料、有人员组织培训，也会受宏观经济政策影响。如果想更好得了解黑产的产业上下游，不妨假设我们现在要做一个黑产工作室，我们会需要以下物料：

- 手机号：用于注册账号、接收验证码
- 设备：安装APP，接收短信
- 网络：网络 IP
- 银行卡：用于诈骗所得提现
- 身份证：用于实名认证等场景

上述物料构成了黑产作案的基础生产工具，同时也形成了成熟的产业服务，以下列举几个核心服务：

- 接码平台：提供手机号及验证码接收服务；接码平台本身是中间交易平台，平台不提供手机号，但可支持拥有大量手机号的卡商入驻，同时以众包的形式，提供听码（针对语音验证码）、打码（针对图形验证码）服务；
- 群控工具：将多台手机设备页面集成到 PC 端，并结合自动化脚本对APP端内操作统一去管理，从而提高整体的操控效率。群控工具最开始是APP多开模拟器，后续发展出了群控、箱控、云控等工具，云控软件在PC端可管理千级别的手机终端；
- 代理IP池：为避开IP黑名单和频控限制策略，可以利用供应商网络构建秒拨平台，形成代理IP池进行随机切换；
- 改机工具：通过技术手段修改设备信息，如设备指纹，从而绕过业务的防控策略；


### 规则引擎

风控具有强对抗性质，这意味着风控策略需要快速更新迭代，在大多数风控平台里，规则引擎都是非常重要的功能模块。规则引擎后端将策略判断和业务代码解耦，前端则通过可视化配置的方式来支持策略的快速迭代上线，从而提高风控业务整体的布控效率。

了解规则引擎之前，需要先对风控策略本身进行抽象。假设有个营销活动规定；未满18岁的男性不得领优惠券。针对这样一个策略，用伪代码的形式可表述为：当 用户领券 时，如果 用户年龄 小于 18岁，且 用户性别 等于 男性，则 拒绝领券；

对上述策略解构，可以得到如下元素：

- Event：事件，描述策略的执行时机，实时策略对应实时用户行为或数据交互，离线策略的事件则可理解为一个定时器；
- Rules：规则，规则本身是对一组表达式做布尔判断，是策略逻辑的主体部分；
    - 规则由多个条件判断表达式组成，每个表达式基本包括左变量、右变量、运算符 三部分；
    - 习惯上倾向于左变量为用户特征，右变量为具体值，但在逻辑上二者可以互换没有差别；
    - 运算符连接左右变量，可分为两类：比较运算符和关系运算符；
        - 比较运算符：大于、大于等于、等于、不等于、小于、小于等于；
        - 关系运算符：在...中、不在...中；
    - 多个条件表达式之间的逻辑关系会引入逻辑运算符，主要是 AND 和 OR ；
- Action：动作，规则判断为「是」的情况系统的后续执行动作；

策略执行首先要获取所需数据，其次是语法解析。一般来讲，策略引用的数据会提前预处理后再提供给规则引擎以提高整体的执行效率。负责预处理数据的产品模块会被称为特征平台。

特征中心提供特征数据的查询、存储和管理，产品设计上不难，困难的点在于指标体系如何设计，这一定程度上反映了业务对风险洞察的水平。特征数据可大致分为三类：画像类、频次类、模型分。

- 画像类：静态或动态的用户数据，典型如手机号、IP、设备名称、APP版本、网络 等；数据可以根据用户行为区分存储，比如注册的数据可以持久化存储，登录的则可以根据用户登录行为动态更新；
- 频次类：基于滑动时间窗口的频次统计，比如“最近30min下单数”，滑动时间窗口可以保证数据的时效性；
- 模型分：模型基于内容或行为序列的打分，需要和模型服务交互获取。

除特征中心的数据外，事件本身也会自带数据。比如用户私聊的时间，私聊的内容会存在这个事件的消息体中，所以规则引擎也可以直接和事件交互来获取数据。基于此，产品设计上可以有一个事件管理模块，用于管理和定义事件及事件流中的数据字段的语义。

关于规则引擎的可视化，很多时间产品经理会有执念。能够配置的就不想写代码，能够点选的就不想去输入，这在用户体验上是没有错。但平台迭代有时候需要全局视角，做什么东西自然很重要，但是在什么时候去做有时候会更重要。

从0到1搭建规则引擎是一项工作量较大的事情，上游需要构建事件和特征的服务，规则引擎本身需要构建语法规范，下游与处罚中心交互，同时需要关注平台稳定性，架构上要对实时数据的高吞吐做好支撑。上来就追求可视化往往会消耗核心资源，在平台稳定性上会造成技术欠账，这是之前做项目时观察的一个经验。
