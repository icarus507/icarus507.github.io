---
layout: post
title: 关于风控（上）
summary: 关键词：风控概念、黑产概述、规则引擎
featured-img: shane-rounce-205187
---
### 风控概念

风控是相当广泛的概念，从金融信贷，到 电商，支付，游戏，社区......不同业务场景下都各自衍生出结合自身业务的风控理解。我们常看到的一些概念，如：反欺诈、反作弊、信贷管控、内容安全、社区治理、电商治理、平台治理、移动安全、WEB安全、账号安全等，都可以纳入风控的范畴。

传统金融信贷业务是风控概念的源起。用户申请贷款，平台审核信用确定是否放贷及对应额度。贷前审核过程就是风险控制的过程。风控把控不利将直接影响到坏账率从而扩大平台资损。但信贷关注坏账率同时更关注放贷量，后者直接影响营收，所以其风控策略要求有强解释性。在这种背景下，评分卡模型得到了大量普及应用。

电商和O2O主要是构造双边市场，对应的风控其实就是平台治理。平台治理一方面关注供给侧，比如商户的刷单、炒信、虚假商品服务等，另一方面关注消费侧，主要是营销反作弊，也就是薅羊毛。商品服务过程中用户和商家也容易产生纠纷，典型如滴滴的司乘纠纷，纠纷的处理有时候也属于平台治理范畴。

知乎、小红书是以内容为主的社区产品，内容的生产、分发和消费是其产品的核心主线，内容安全是重中之重。用户发布的内容是否符合国家的相关法律法规，平台需要承担主体责任，这一规定确定了内容安全是社区产品的生死线。在内容安全之上，用户发布的内容是否符合平台本身的社区调性，也需要治理和把控，但一般不纳入风控体系，大多归属于社区内容运营。

探探、陌陌是典型的陌生人社交产品，用户在平台内与其他用户建立社交联系，进而发展成稳固的社交关系，平台基于社交关系开展增值付费业务。社交关系的快速建立，使得陌生人社交产品黑产也同样可以基于社交关系积累的信任度进行诈骗和导流，典型的如杀猪盘、狗推等，这是社区风控重点打压的情况。

除上述业务自身特有的风控场景外，APP本身的安全、用户账号的安全等也需要关注，安全上存在漏洞坑会造成用户数据泄露或资产受损。

### 黑产概述

黑产是一个成熟的产业链，有分工、上下游、专业的生产资料、体系化的人员培训等，同时也会受宏观政策影响。想更好了解黑产产业链，不妨先假设自己要做黑产工作室。成立第一步需要以下物料：手机号、移动设备、网络、银行卡、身份证等。这些物料构成了黑产作案的基础生产工具。

为了能够快速给下游提供物料，黑产形成了细分的产业，对下游提供saas服务，比如：

- 接码平台：提供手机号及验证码接收服务；
- 群控工具：将多台手机设备集成到 PC 端统一去管理，提高整体操控效率；
- 代理IP池：提供大量备用IP支持随机切换，用于避开IP黑名单和频控限制策略；
- 改机工具：通过技术手段修改设备信息，绕过设备纬度的防控策略；

获取基础物料后，可以选择细分的黑产业务，比如：

- 虚假流量：批量注册账号用于刷赞、刷点击、刷评论、刷粉等；
- 薅羊毛：以新用户的身份获取平台折扣、返现、抽奖、满减等权益；
- 刷单炒信：通过虚假订单来提高商户的交易量、评分和信用等级等；
- 杀猪盘：诱骗他人投资赌博进行诈骗；
- 狗推：给博彩网站引流；
- 导流：给黑五类产品导流赚取佣金；

黑产不会只开展一个业务，账号注册后可以开展多种黑产行为，直至账号被封禁。业务会根据风险情报和已知作弊内容设计风控策略，黑产同时也会试探业务策略逻辑从而升级作案方式，二者始终处在对抗状态。


### 规则引擎

风控的强对抗性意味着策略需要快速更新迭代，因此规则引擎是非常重要的功能模块。规则引擎在技术架构上将策略判断和业务代码解耦，支持快速部署上线，前端则以可视化方式来进行策略配置，从而降低策略配置门槛。

了解规则引擎之前先对策略本身抽象。假设有营销活动规定；未满18岁的男性不得领优惠券。针对这样一个策略，用伪代码的形式可表述为：当 用户领券 时，如果 用户年龄 小于 18岁，且 用户性别 等于 男性，则 拒绝领券；

对上述策略解构，可以得到如下元素：

- Event：事件，描述策略的执行时机，实时策略对应实时用户行为或数据交互，离线策略的事件则可理解为一个定时器；
- Rules：规则，规则本身是对一组表达式做布尔判断，是策略逻辑的主体部分；
    - 规则由多个条件判断表达式组成，每个表达式基本包括左变量、右变量、运算符 三部分；
    - 习惯上倾向于左变量为用户特征，右变量为具体值，但在逻辑上二者可以互换没有差别；
    - 运算符连接左右变量，可分为两类：比较运算符和关系运算符；
        - 比较运算符：大于、大于等于、等于、不等于、小于、小于等于；
        - 关系运算符：在...中、不在...中；
    - 多个条件表达式之间的逻辑关系会引入逻辑运算符，主要是 AND 和 OR ；
- Action：动作，规则判断为「是」的情况系统的后续执行动作；

策略执行首先要获取所需数据，其次是语法解析。一般来讲，策略引用的数据会提前预处理后再提供给规则引擎以提高整体的执行效率。负责预处理数据的产品模块会被称为特征平台。

特征中心提供特征数据的查询、存储和管理，产品设计上不难，困难的点在于指标体系如何设计，这一定程度上反映了业务对风险洞察的水平。特征数据可大致分为三类：画像类、频次类、模型分。

- 画像类：静态或动态的用户数据，典型如手机号、IP、设备名称、APP版本、网络 等；数据可以根据用户行为区分存储，比如注册的数据可以持久化存储，登录的则可以根据用户登录行为动态更新；
- 频次类：基于滑动时间窗口的频次统计，比如“最近30min下单数”，滑动时间窗口可以保证数据的时效性；
- 模型分：模型基于内容或行为序列的打分，需要和模型服务交互获取。

除特征中心的数据外，事件本身也会自带数据。比如用户私聊的时间，私聊的内容会存在这个事件的消息体中，所以规则引擎也可以直接和事件交互来获取数据。基于此，产品设计上可以有一个事件管理模块，用于管理和定义事件及事件流中的数据字段的语义。

关于规则引擎的可视化，很多时间产品经理会有执念。能够配置的就不想写代码，能够点选的就不想去输入，这在用户体验上是没有错。但平台迭代有时候需要全局视角，做什么东西自然很重要，但是在什么时候去做有时候会更重要。

从0到1搭建规则引擎是一项工作量较大的事情，上游需要构建事件和特征的服务，规则引擎本身需要构建语法规范，下游与处罚中心交互，同时需要关注平台稳定性，架构上要对实时数据的高吞吐做好支撑。上来就追求可视化往往会消耗核心资源，在平台稳定性上会造成技术欠账，这是之前做项目时观察的一个经验。
